kind: pipeline
type: docker
name: default

steps:
  # - name: build
  #   image: node:13.12.0-alpine
  #   commands:
  #   - yarn install

  # - name: test
  #   image: node:13.12.0-alpine
  #   commands:
  #   - npm run test

  # - name: docker-build
  #   image: plugins/docker
  #   settings:
  #     username: ${username}
  #     password: ${password}
  #     repo: shannonhung/react-myread
  #     tags: latest
  

# 失敗...不知道為甚麼QQIKjU9SIQRYW6T8lcKllzZvxK
  - name: notify
    image: plugins/slack
    settings:
      access_token: xoxb-1612877955221-1601203692583-3aaeRKQLNIv1XnpX37mvNNqF
      webhook: https://hooks.slack.com/services/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
      channel: workspace
      template: >
        *{{#success build.status}}✔{{ else }}✘{{/success}} {{ uppercasefirst build.status }}: Build #{{ build.number }}* (type: `{{ build.event }}`)

        Commit: {{ repo.name }}/{{ truncate build.commit 8 }}

        Branch: {{ build.branch }}

        Author: {{ build.author }}

        <{{ build.link }}|Visit build page ↗>
    when:
      branch:
        - master
      event:
        - push
      status: [ success, failure ]
